bot.controller(
    "wspController",
    function (
      $window,
      $scope,
      $http,
      $cookies,
      $filter,
      $timeout,
      $rootScope,
      $interval,
      hostValue
    ) {
        $scope.spinner=!0,$scope.cajaRegistro="cajaRegistro fade-in",$timeout((()=>{$scope.cajaRegistro="cajaRegistro"}),1e3);var rangoUsuario=$cookies.get("rango");$scope.mostraGuardarDatosCliente=!0;const hostWeb=hostValue;$scope.rangoActual=rangoUsuario,$scope.nombreUsuarioCookie=$cookies.get("usuario"),$scope.objEmpleados=[],$scope.notificaciones=[],$scope.hayNuevoMensaje=[];const fileReader=new FileReader;$scope.esArchivo=!1,$scope.arContactos=[],$scope.chatClienteAux=[],$scope.showAlert=!1,$scope.registroMensaje=!0,$scope.chatMensaje=!0,$scope.mostrarEnviarMensaje=!1,$scope.btnVolver=!1,$scope.modoDios=!1,$scope.mostrarMenuCard=!1,$scope.showDatosDelCliente=!1,$scope.showDatosDelCliente=!1,$scope.mostrarMenuBotones=!0,$scope.chatModoDios=!1;var dingSonado=!1;$scope.contadorUltimoId=0;const socket=io(hostValue+":5000");socket.emit("login",$cookies.get("rango"),$cookies.get("usuario")),socket.on("connect",(function(){socket.emit("getMensajes",$scope.chatModoDios,$scope.contadorUltimoId,$cookies.get("rango"),$cookies.get("usuario"))})),socket.on("mensajes",(function(e,o){$scope.$apply((function(){$scope.datosRecibidos=e,$scope.iniciarApp(!1,$scope.datosRecibidos)}))})),$scope.$on("$destroy",(function(){socket.disconnect()}));var filtroRango="filtroRango";function getContactos(){$scope.arContactos=[],$http.get(hostWeb+":8081/contacto/getContactos").then((e=>{$scope.arContactos=e.data,$scope.contactosId=e.data,$scope.arContactos.map((function(e){e.telefono=e.telefono.replace("@c.us","")})),$scope.objContactos=$scope.arContactos.slice(-10)}))}screen.width<=425&&($scope.chatMensaje=!1,$scope.btnVolver=!0),$scope.mostrarChat=function(){$scope.chatMensaje=!0,$scope.registroMensaje=!1};const getContactosCallBack=e=>{$http.get(hostWeb+":8081/contacto/getContactos").then((o=>{e(o.data)}))};function ding(){}function checkLogin(){null==rangoUsuario&&($window.location.href=hostWeb+"/sidelink/frontend/login.html"),"admin"===$cookies.get("rango")?$scope.capaDelasSombrasOperador=!0:$scope.capaDelasSombrasOperador=!1}function obtenerEmp(){$http.get(hostWeb+":8081/chat/empleados").then((function(e){var o=e.data;angular.forEach(o,(function(e){e.rango!==rangoUsuario&&"medusa"!==e.rango&&$scope.objEmpleados.push(e)}))}))}function controlarMensajeConImagenCliente(e,o){""!==e.imgurl&&($scope.mostrarMediaImagen=!1,$scope.mostrarMediaVideo=!1,$scope.mostrarMediaAudio=!1,$scope.mostrarDocumentoDoc=!1,$scope.mostrarDocumentoXls=!1,$scope.mostrarDocumentoPdf=!1,$scope.mostrarDocumentoCsv=!1,$scope.mostrarPng=!1,e.imgurl.includes(".jpg")||e.imgurl.includes(".jpeg")||e.imgurl.includes(".jfif")?($scope.img={"background-image":"url(../../../sidelink/backend/"+e.imgurl+")","background-repeat":"no-repeat","background-size":"contain","background-position":"center",width:"300px",height:"300px","grid-column":"1/ span 2","grid-row":"1"},screen.width<=425&&($scope.img={"background-image":"url(../../../sidelink/backend/"+e.imgurl+")","background-repeat":"no-repeat","background-size":"contain","background-position":"center",width:"175px",height:"300px","grid-column":"1/ span 2","grid-row":"1"}),e.mensaje="",$scope.mostrarMediaImagen=!0,$scope.mostrarMediaVideo=!1,$scope.mostrarMediaAudio=!1,$scope.mostrarDocumentoDoc=!1,$scope.mostrarDocumentoXls=!1,$scope.mostrarDocumentoPdf=!1,$scope.mostrarDocumentoCsv=!1,$scope.mostrarPng=!1):e.imgurl.includes(".mp4")?($scope.mostrarMediaVideo=!0,$scope.mostrarMediaImagen=!1,$scope.mostrarMediaAudio=!1,$scope.mostrarDocumentoDoc=!1,$scope.mostrarDocumentoXls=!1,$scope.mostrarDocumentoPdf=!1,$scope.mostrarDocumentoCsv=!1,$scope.mostrarPng=!1,$scope.media="../../sidelink/backend/"+e.imgurl):e.imgurl.includes(".wav")||e.imgurl.includes(".mp3")?($scope.mostrarMediaAudio=!0,$scope.mostrarMediaImagen=!1,$scope.mostrarMediaVideo=!1,$scope.mostrarDocumentoDoc=!1,$scope.mostrarDocumentoXls=!1,$scope.mostrarDocumentoPdf=!1,$scope.mostrarDocumentoCsv=!1,$scope.mostrarPng=!1,$scope.media="../../sidelink/backend/"+e.imgurl):e.imgurl.includes(".doc")?($scope.mostrarDocumentoDoc=!0,$scope.mostrarDocumentoXls=!1,$scope.mostrarDocumentoPdf=!1,$scope.mostrarDocumentoCsv=!1,$scope.mostrarMediaImagen=!1,$scope.mostrarMediaVideo=!1,$scope.mostrarMediaAudio=!1,$scope.mostrarPng=!1,nombreMedia=o.telefono.replace("@c.us","")+e.fecha+e.mensaje,$scope.media=""):e.imgurl.includes(".xls")?($scope.mostrarDocumentoDoc=!1,$scope.mostrarDocumentoXls=!0,$scope.mostrarDocumentoPdf=!1,$scope.mostrarDocumentoCsv=!1,$scope.mostrarMediaImagen=!1,$scope.mostrarMediaVideo=!1,$scope.mostrarMediaAudio=!1,$scope.mostrarPng=!1,nombreMedia=o.telefono.replace("@c.us","")+e.fecha+e.mensaje,$scope.media=""):e.imgurl.includes(".pdf")?($scope.mostrarDocumentoDoc=!1,$scope.mostrarDocumentoXls=!1,$scope.mostrarDocumentoPdf=!0,$scope.mostrarDocumentoCsv=!1,$scope.mostrarMediaImagen=!1,$scope.mostrarMediaVideo=!1,$scope.mostrarMediaAudio=!1,$scope.mostrarPng=!1,nombreMedia=o.telefono.replace("@c.us","")+e.fecha+e.mensaje,$scope.media=""):e.imgurl.includes(".csv")?($scope.mostrarDocumentoDoc=!1,$scope.mostrarDocumentoXls=!1,$scope.mostrarDocumentoPdf=!1,$scope.mostrarDocumentoCsv=!0,$scope.mostrarMediaImagen=!1,$scope.mostrarMediaVideo=!1,$scope.mostrarMediaAudio=!1,$scope.mostrarPng=!1,nombreMedia=o.telefono.replace("@c.us","")+e.fecha+e.mensaje,$scope.media=""):e.imgurl.includes(".png")&&($scope.img={"background-image":"url(../../../sidelink/backend/"+e.imgurl+")","background-repeat":"no-repeat","background-size":"contain","background-position":"center",width:"300px",height:"300px","grid-column":"1/ span 2","grid-row":"1"},$scope.mostrarDocumentoDoc=!1,$scope.mostrarDocumentoXls=!1,$scope.mostrarDocumentoPdf=!1,$scope.mostrarDocumentoCsv=!1,$scope.mostrarMediaImagen=!1,$scope.mostrarPng=!0,$scope.mostrarMediaVideo=!1,$scope.mostrarMediaAudio=!1,nombreMedia=o.telefono.replace("@c.us","")+e.fecha+e.mensaje,$scope.media="",e.mensaje=""))}function controlarMensajeConImagen(e,o){""!==e.imgurl&&($scope.mostrarMediaImagen=!1,$scope.mostrarMediaVideo=!1,$scope.mostrarMediaAudio=!1,$scope.mostrarDocumentoDoc=!1,$scope.mostrarDocumentoXls=!1,$scope.mostrarDocumentoPdf=!1,$scope.mostrarDocumentoCsv=!1,$scope.mostrarPng=!1,e.imgurl.includes(".jpg")||e.imgurl.includes(".jpeg")||e.imgurl.includes(".jfif")?($scope.img={"background-image":"url(../../../sidelink/backend/"+e.imgurl+")","background-repeat":"no-repeat","background-size":"contain","background-position":"center",width:"300px",height:"300px","grid-column":"1/ span 2","grid-row":"1"},screen.width<=425&&($scope.img={"background-image":"url(../../../sidelink/backend/"+e.imgurl+")","background-repeat":"no-repeat","background-size":"contain","background-position":"center",width:"175px",height:"300px","grid-column":"1/ span 2","grid-row":"1"}),e.mensaje="",$scope.mostrarMediaImagen=!0,$scope.mostrarMediaVideo=!1,$scope.mostrarMediaAudio=!1,$scope.mostrarDocumentoDoc=!1,$scope.mostrarDocumentoXls=!1,$scope.mostrarDocumentoPdf=!1,$scope.mostrarDocumentoCsv=!1,$scope.mostrarPng=!1):e.imgurl.includes(".mp4")?($scope.mostrarMediaVideo=!0,$scope.mostrarMediaImagen=!1,$scope.mostrarMediaAudio=!1,$scope.mostrarDocumentoDoc=!1,$scope.mostrarDocumentoXls=!1,$scope.mostrarDocumentoPdf=!1,$scope.mostrarDocumentoCsv=!1,$scope.mostrarPng=!1,$scope.media="../../sidelink/backend/"+e.imgurl):e.imgurl.includes(".wav")||e.imgurl.includes(".mp3")?($scope.mostrarMediaAudio=!0,$scope.mostrarMediaImagen=!1,$scope.mostrarMediaVideo=!1,$scope.mostrarDocumentoDoc=!1,$scope.mostrarDocumentoXls=!1,$scope.mostrarDocumentoPdf=!1,$scope.mostrarDocumentoCsv=!1,$scope.mostrarPng=!1,$scope.media="../../sidelink/backend/"+e.imgurl):e.imgurl.includes(".doc")?($scope.mostrarDocumentoDoc=!0,$scope.mostrarDocumentoXls=!1,$scope.mostrarDocumentoPdf=!1,$scope.mostrarDocumentoCsv=!1,$scope.mostrarMediaImagen=!1,$scope.mostrarMediaVideo=!1,$scope.mostrarMediaAudio=!1,$scope.mostrarPng=!1,nombreMedia=o.telefono.replace("@c.us","")+e.fecha+e.mensaje,$scope.media=""):e.imgurl.includes(".xls")?($scope.mostrarDocumentoDoc=!1,$scope.mostrarDocumentoXls=!0,$scope.mostrarDocumentoPdf=!1,$scope.mostrarDocumentoCsv=!1,$scope.mostrarMediaImagen=!1,$scope.mostrarMediaVideo=!1,$scope.mostrarMediaAudio=!1,$scope.mostrarPng=!1,nombreMedia=e.infoCliente.telefono.replace("@c.us","")+e.fecha+e.mensaje,$scope.media=""):e.imgurl.includes(".pdf")?($scope.mostrarDocumentoDoc=!1,$scope.mostrarDocumentoXls=!1,$scope.mostrarDocumentoPdf=!0,$scope.mostrarDocumentoCsv=!1,$scope.mostrarMediaImagen=!1,$scope.mostrarMediaVideo=!1,$scope.mostrarMediaAudio=!1,$scope.mostrarPng=!1,nombreMedia=o.telefono.replace("@c.us","")+e.fecha+e.mensaje,$scope.media=""):e.imgurl.includes(".csv")?($scope.mostrarDocumentoDoc=!1,$scope.mostrarDocumentoXls=!1,$scope.mostrarDocumentoPdf=!1,$scope.mostrarDocumentoCsv=!0,$scope.mostrarMediaImagen=!1,$scope.mostrarMediaVideo=!1,$scope.mostrarMediaAudio=!1,$scope.mostrarPng=!1,nombreMedia=value.telefono.replace("@c.us","")+e.fecha+e.mensaje,$scope.media=""):e.imgurl.includes(".png")&&($scope.img={"background-image":"url(../../../sidelink/backend/"+e.imgurl+")","background-repeat":"no-repeat","background-size":"contain","background-position":"center",width:"300px",height:"300px","grid-column":"1/ span 2","grid-row":"1"},$scope.mostrarDocumentoDoc=!1,$scope.mostrarDocumentoXls=!1,$scope.mostrarDocumentoPdf=!1,$scope.mostrarDocumentoCsv=!1,$scope.mostrarMediaImagen=!1,$scope.mostrarMediaVideo=!1,$scope.mostrarMediaAudio=!1,$scope.mostrarPng=!0,nombreMedia=value.telefono.replace("@c.us","")+e.fecha+e.mensaje,$scope.media="",e.mensaje=""))}function removeAccents(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function alerta(e,o){return SnackBar({message:e,dismissible:!0,status:o,timeout:25e3,position:"tr"}),!1}$scope.mostrarRegistroMensaje=function(){$scope.chatMensaje=!1,$scope.registroMensaje=!0},$scope.scrollToBottom=function(){$timeout((()=>{var e=document.getElementById("chatt");e.scrollTop=e.scrollHeight}))},$scope.irADifusion=function(){$window.location.href=hostWeb+"/sidelink/frontend/difundir.html"},$scope.irAEstadisticas=function(){$window.location.href=hostWeb+"/sidelink/frontend/estadisticas.html"},$scope.irATickets=function(){$window.location.href=hostWeb+"/sidelink/frontend/tickets.html"},$scope.irATicketsContacto=function(){$window.open(hostWeb+"/sidelink/frontend/tickets.html","_blank")},$scope.irAContactos=function(){$window.location.href=hostWeb+"/sidelink/frontend/contactos.html"},$scope.irAEmail=function(){$window.location.href=hostWeb+"/sidelink/frontend/email.html"},$scope.contadorMensajesCliente=0,$scope.contadorMensajes=0,checkLogin(),obtenerEmp(),getContactos(),$scope.iniciarApp=function(e,o){$scope.chatModoDios?$scope.aletrnarChat=!0:$scope.aletrnarChat=!1,e?(e=!1,$scope.obtenerMensajes(o)):$scope.obtenerMensajes(o)},$scope.cerrarSesion=function(){$http.post(hostWeb+":8081/login/cerrarSesion",{nombre:$cookies.get("usuario")}),$cookies.remove("rango"),$cookies.remove("nombre"),$window.location.href=hostWeb+"/sidelink/frontend/login.html"},$scope.cambiarModoDios=()=>{$scope.spinner=!0,socket.emit("getMensajes",$scope.chatModoDios,$scope.contadorUltimoId,$cookies.get("rango"),$cookies.get("usuario"))},$scope.seleccionarContacto=function(e){var o=new Date,a=$filter("date")(o,"dd/MM/yyyy - HH:mm:ss"),s=$filter("date")(o,"dd/MM/yyyy");e.telefono=e.telefono.replace("+",""),$http.post(hostWeb+":8081/chat/contactoActivo",{nombre:e.nombre,numero:e.telefono,rangoPrevio:rangoUsuario,rangoPosterior:rangoUsuario,fecha:a,fechaBuscar:s,nombreUsuario:$scope.nombreUsuarioCookie,rangoUsuario:rangoUsuario})},$scope.mostrarMenu=()=>{$scope.chatCliente=[],$scope.nombreCliente="",$scope.nombreClienteCard="",$scope.numeroClienteImagen="",$scope.numeroCliente="",$scope.fotoPerfil="",$scope.showDatosDelCliente=!1,$scope.mostrarEnviarMensaje=!1,$scope.mostrarMenuBotones=!0,$scope.mostrarMenuCard=!1},$scope.seleccionarRegistro=e=>{$scope.clienteSeleccionadoCambiarRango=e},$scope.buscarClienteIspCube=()=>{$scope.datosClienteDesdeIspCube="";const e=$cookies.get("dniTicket");$http.post("http://132.255.224.147:5001/getCliente",{documento:e}).then((o=>($scope.datosClienteDesdeIspCube=o.data,$http.post("http://132.255.224.147:5001/verConexion",{documento:e})))).then((o=>($scope.datosClienteDesdeIspCube.connections=o.data.map((e=>({id:e.id,name:e.plan.name,user:e.user,password:e.password,node:e.node}))),$http.post("http://132.255.224.147:5001/getFactura6",{documento:e})))).then((e=>{$scope.datosClienteDesdeIspCube.factura=e.data})).catch((e=>{console.error("Error en la búsqueda del cliente:",e)}))},$scope.cambiarRangoCliente=function(e){let o=$scope.clienteSeleccionadoCambiarRango;var a=new Date,s=$filter("date")(a,"dd/MM/yyyy - HH:mm:ss"),t=$filter("date")(a,"dd-MM-yyyy"),c="";c="admin"===rangoUsuario?"*El cliente fue derivado por un administrador*":"*El cliente fue derivado del area "+rangoUsuario+"*",$http.post(hostWeb+":8081/chat/cambiarRangoCliente",{rangoUsuario:rangoUsuario,rangoPrevio:e,telefono:o.telefono,rangoPosterior:o.rango,nombre:o.nombre,urlPerfil:o.avatar,fecha:s,fechaBuscar:t,mensaje:c,dispositivo:"bot",nombreUsuario:$scope.nombreUsuarioCookie,rangoUsuario:rangoUsuario}).then((()=>{$scope.areaDerivacion=e,alerta("Se derivó el cliente "+o.nombre+" al área "+e,"success")}))},$scope.obtenerMensajes=function(e){$scope.notificaciones=[],$scope.mensajes=e,$scope.chat=e,$scope.spinner=!1,$scope.filtrarMensajes($cookies.get("telefono"),e)},$scope.filtrarMensajes=function(e,o){o.length>0&&"click"===o?($scope.spinner=!0,$scope.chatClass="chat"):($scope.esChat=!0,$scope.chatClass="chat fade-in"),document.getElementById("inpMensaje").focus(),$scope.chatCliente=[],$cookies.put("telefono",e);var a="",s=$scope.mensajes,t="#",c="#";$scope.esArchivo=!1,$scope.urlPerfil="",$scope.nombreCliente="",$scope.numeroCliente="",$scope.direccionCliente="",$scope.dniCliente="",$scope.descripcionCliente="";var r="",n=[],i={};$scope.cajaSeleccionada=[],angular.forEach(s,(function(o){e===o.infoCliente.telefono&&(n=o.mensajes,i=o.infoCliente)})),$scope.nombreCliente=i.codigoIspcube+" "+i.nombre,$scope.nombreClienteCard=i.nombre,$scope.numeroClienteImagen=i.telefono,$scope.numeroCliente=i.telefono.replace("@c.us",""),void 0===i.descripcion&&(i.descripcion=""),void 0===i.direccion&&(i.direccion=""),$scope.descripcionCliente=i.descripcion,$scope.direccionCliente=i.direccion,$scope.dniCliente=i.dni,$scope.nombreCliente=i.codigoIspcube+" "+i.nombre,$scope.nombreClienteCard=i.nombre,$scope.numeroClienteImagen=i.telefono,$scope.numeroCliente=i.telefono.replace("@c.us",""),(n.length>0||void 0!==i)&&($scope.clienteSeleccionadoCambiarRango=i,$scope.urlPerfil=i.avatar,angular.forEach(n,(o=>{c=i.telefono.replace("@c.us","")+o.fecha,$scope.mostrarMenuBotones=!1,$scope.mostrarMenuCard=!0,$scope.mostrarEnviarMensaje=!0,$scope.showDatosDelCliente=!0,$scope.telefonoGlobal=e,$scope.nombreGlobal=i.nombre,""===o.imgurl&&($scope.mostrarMediaImagen=!1,$scope.mostrarMediaVideo=!1,$scope.mostrarMediaAudio=!1,$scope.mostrarDocumentoDoc=!1,$scope.mostrarDocumentoXls=!1,$scope.mostrarDocumentoPdf=!1,$scope.mostrarDocumentoCsv=!1,$scope.mostrarPng=!1,$scope.media=""),0==o.estado?(t="../../../sidelink/backend/"+o.imgurl,a=$scope.mensajeStyleMedusa,r=" - "+o.rangoMensaje,$scope.media="",$scope.mostrarMediaImagen=!1,$scope.mostrarMediaVideo=!1,$scope.mostrarMediaAudio=!1,$scope.mostrarDocumentoDoc=!1,$scope.mostrarDocumentoXls=!1,$scope.mostrarDocumentoPdf=!1,$scope.mostrarDocumentoCsv=!1,$scope.mostrarPng=!1,controlarMensajeConImagenCliente(o,i)):1==o.estado?(t="../../../sidelink/backend/"+o.imgurl,controlarMensajeConImagen(o,i),r="",a=$scope.mensajeStyleCliente):2==o.estado?a=$scope.mensajeStyleRobot:3==o.estado&&(a=$scope.mensajeStyleRobotDatosDerivados);var s={mensaje:o.mensaje,fecha:o.fecha,estado:o.estado,estilo:a,media:$scope.media,img:$scope.img,mostrarMediaImagen:$scope.mostrarMediaImagen,mostrarMediaVideo:$scope.mostrarMediaVideo,mostrarMediaAudio:$scope.mostrarMediaAudio,mostrarDocumentoDoc:$scope.mostrarDocumentoDoc,mostrarDocumentoXls:$scope.mostrarDocumentoXls,mostrarDocumentoPdf:$scope.mostrarDocumentoPdf,mostrarDocumentoCsv:$scope.mostrarDocumentoCsv,mostrarPng:$scope.mostrarPng,download:t,nombreMedia:c,rango:r,nombreUsuario:o.usuario};$scope.chatCliente.push(s)}))),$scope.idContactoSeleccionado=$scope.contactosId.filter((e=>e.telefono+"@c.us"===i.telefono)).map((e=>({idContacto:e.idContacto,dni:e.dni}))),$cookies.put("ticket",$scope.idContactoSeleccionado[0].idContacto),$cookies.put("dniTicket",$scope.idContactoSeleccionado[0].dni),$scope.chatCliente.reverse(),$scope.chatClienteAux=$scope.chatCliente,"click"===o?($scope.scrollToBottom(),$timeout((function(){$scope.chatCliente.length===n.length&&($scope.spinner=!1,$scope.chatClass="chat fade-in")}))):$scope.chatCliente.length===n.length&&($scope.scrollToBottom(),dingSonado||(ding(),dingSonado=!0,$timeout((()=>{dingSonado=!1}),2e3)))},$scope.enviarMensaje=function(e){var o="",a="",s=new Date,t=$filter("date")(s,"dd/MM/yyyy - HH:mm:ss"),c=$filter("date")(s,"dd-MM-yyyy");if(e.shiftKey&&"Enter"===e.key)$scope.mensaje+="\n",e.preventDefault();else if(("Enter"==e.key||"click"==e.type)&&""!=$scope.mensaje){$scope.esArchivo?(o=!0,a=$scope.mensaje):o=!1;var r=$scope.mensaje;r=(r=(r=r.replace(/'/g,"")).replace(/"/g,"")).replace(/\\/g,""),$http.post(hostWeb+":8081/chat/mensajeMedusa",{nombre:$scope.nombreGlobal,telefono:$scope.telefonoGlobal.replace("+",""),from:$scope.telefonoGlobal.replace("+",""),fecha:t,fechaBuscar:c,mensaje:r,dispositivo:"bot",imgurl:a,estado:0,bool:!1,rango:$scope.rangoActual,enviaArchivo:o,nombreUsuario:$scope.nombreUsuarioCookie,rangoClienteActivo:$scope.clienteSeleccionadoCambiarRango.rango}).success((function(e){$scope.mensaje=""}))}},$scope.mensajeClienteActivo=function(e,o,a){var s=new Date,t=$filter("date")(s,"dd/MM/yyyy - HH:mm:ss");$http.post(hostWeb+":8081/chat/mensajeMedusa",{nombre:o,telefono:a,fecha:t,mensaje:e,dispositivo:"bot",imgurl:"",estado:2,bool:!1,rango:"medusa",attachmentData:$scope.attachmentData,nombreUsuario:"medusa"}).success((function(e){})).finally((function(){}))},$scope.cerrarChat=function(){let e=$scope.clienteSeleccionadoCambiarRango.telefono;$http.post(hostWeb+":8081/chat/cerrarChat",{telefono:e,rangoUsuario:rangoUsuario,rangoPrevio:$scope.clienteSeleccionadoCambiarRango.rango}).success((function(e){}))},$scope.fotoPerfil={"border-radius":"40px",width:"50px",height:"50px","box-shadow":"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)"},$scope.fotoPerfilCard={"background-position":"center","border-radius":"60px",width:"120px",height:"120px",margin:"2% auto","box-shadow":"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)"},$scope.mensajeStyleCliente={"border-radius":"0px 19px 19px 19px","background-color":"rgba(255, 255, 255)","box-shadow":"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",padding:"2% 2%",color:"black","font-size":"17px","font-family":"Roboto, sans-serif","justify-self":"start","align-self":"center","margin-left":"12%","grid-column":"1","max-width":"90%"},$scope.mensajeStyleMedusa={"box-shadow":"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)","border-radius":"19px 19px 0px 19px","background-color":"#c4e1f4",padding:"2% 2%",color:"black","font-size":"17px","font-family":"Roboto, sans-serif","justify-self":"center","align-self":"center","margin-left":"auto","margin-right":"5%","grid-column":"1 / span 2","max-width":"46%"},$scope.mensajeStyleRobot={"box-shadow":"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)","border-radius":"10px","background-color":"#598d9ab3",padding:".7%",color:"black","font-family":"Roboto, sans-serif","justify-self":"center","align-self":"center","grid-column":"1 / span 2","max-width":"40%"},$scope.mensajeStyleRobotDatosDerivados={"border-radius":"10px","background-color":"#62ae7b",padding:".7%",color:"black","font-family":"monospace","justify-self":"center","align-self":"center","grid-column":"1 / span 2","text-align:":"center","max-width":"46%","white-space":"pre-line"},$scope.styleFondoGradient={background:"var(--light-grad-pink-blue, radial-gradient(ellipse at 40% 0%, #093738 0, transparent 75%), radial-gradient(ellipse at 60% 0%, #096bde10 0, transparent 75%))"},$scope.cambiarColor=function(e){$scope.styleFondoGradient={background:`var(--light-grad-pink-blue, radial-gradient(ellipse at 40% 0%, #093738 0, transparent 75%), radial-gradient(ellipse at 60% 0%, ${e} 0, transparent 75%))`}},$scope.url="",$scope.SelectFile=function(e){e.preventDefault(),$scope.mensaje="",$scope.host="",$scope.attachmentData="",$scope.estiloArchivo={},$scope.urlArchivo="";let o=document.getElementById("imgDer").files[0];const a=new FileReader;a.readAsDataURL(o),$scope.mensaje=o.name,$scope.mensaje=$scope.mensaje.replace(/ /g,""),a.addEventListener("load",(e=>{$scope.attachmentData="",$scope.esArchivo=!0,$scope.esChat=!1,$scope.spinner=!0,$scope.attachmentData=e.target.result;let o="./subir/";$scope.attachmentData=$scope.attachmentData.replace("data:image/jpg;base64,",""),$scope.attachmentData=$scope.attachmentData.replace("data:image/png;base64,",""),$scope.attachmentData=$scope.attachmentData.replace("data:image/jpeg;base64,",""),$scope.attachmentData=$scope.attachmentData.replace("data:application/pdf;base64,",""),$scope.attachmentData=$scope.attachmentData.replace("data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,",""),$scope.attachmentData=$scope.attachmentData.replace("data:audio/wav;base64,",""),$scope.attachmentData=$scope.attachmentData.replace("data:audio/mpeg;base64,",""),$scope.attachmentData=$scope.attachmentData.replace("data:video/mp4;base64,",""),$scope.urlArchivo=o+$scope.mensaje,$timeout((()=>{$scope.spinner=!1,$scope.estiloArchivo={"background-image":"url(../../../sidelink/backend/subir/"+$scope.mensaje+")","background-position":"center","background-repeat":"no-repeat","background-size":"contain",height:"70vh",width:"400px","margin-left":"auto","margin-right":"auto"}}),1e3),document.getElementById("inpMensaje").focus(),$http.post(hostWeb+":8081/chat/guardar",{archivo:$scope.attachmentData,ruta:o,nombre:$scope.mensaje}).success((function(e){$scope.attachmentData="",o="",$scope.mensaje=""}))}))},$scope.editarContacto=function(){var e=$scope.clienteSeleccionadoCambiarRango.rango;$http.post(hostWeb+":8081/contacto/editarContacto",{idContacto:$scope.idContactoSeleccionado[0].idContacto,telefono:$scope.numeroCliente+"@c.us",nombre:$scope.nombreClienteCard,conexion:"",nombreCompuesto:$scope.nombreClienteCard,descripcion:$scope.descripcionCliente,direccion:$scope.direccionCliente,urlPerfil:$scope.urlPerfil,rangoUsuario:rangoUsuario,rangoClienteActivo:e,dni:$scope.dniCliente}).success((function(e){e&&(alerta("Se editó el contacto exitosamente!","warning"),$cookies.put("dni",$scope.dniCliente))}))},$scope.buscarContacto=e=>{void 0!==e&&($scope.objContactos=[],angular.forEach($scope.arContactos,(o=>{["idContacto","nombre","telefono","descripcion","direccion","producto"].forEach((a=>{o[a]&&o[a].toString().toLowerCase().includes(e.toLowerCase())&&$scope.objContactos.push(o)}))})))},$scope.imagenNoCargada=e=>{e.src="./style/perfilVacio.png",e.alt="Error al cargar la imagen"},$scope.hacerZoom=function(e){$scope.imagenZoom="",$scope.imagenZoom=e};

}
);